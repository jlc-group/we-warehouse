# üîç ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ SPOUT-LW02 ‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô (VER 2.0)

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ‚úÖ
- SPOUT-LW02 ‡∏°‡∏µ 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏ï‡πá‡∏≠‡∏Å **‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á**
- ‡∏û‡∏ö‡∏ß‡πà‡∏≤ calculateTotalQuantity function ‡πÉ‡∏ä‡πâ conversion rates ‡∏ú‡∏¥‡∏î (144/12 ‡πÅ‡∏ó‡∏ô 1000/100 ‡∏à‡∏£‡∏¥‡∏á)
- **‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å:** ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÑ‡∏î‡πâ

## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Debug Tool
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà http://localhost:5173/
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠" (Tools)
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà "üîç Debug SPOUT"

### 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SPOUT-LW02
Debug tool ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á:
- üì¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô SPOUT-LW02 ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
- üî¥ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ)
- üü¢ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ)

### 3. ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° "‡∏•‡∏ö" ‡∏™‡∏µ‡πÅ‡∏î‡∏á
- ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏•‡∏ö" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡πâ‡∏ô
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á confirmation dialog ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö‡∏à‡∏£‡∏¥‡∏á

### 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à:
- ‡∏Ñ‡∏•‡∏¥‡∏Å "üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" -> "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ

### ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç calculateTotalQuantity function (Dynamic Conversion Rates)
```typescript
// ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà - ‡∏î‡∏∂‡∏á conversion rates ‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
const calculateTotalQuantity = async (item: InventoryItem): Promise<number> => {
  const level1 = item.unit_level1_quantity || 0;
  const level2 = item.unit_level2_quantity || 0;
  const level3 = item.unit_level3_quantity || 0;

  let level1Rate = item.unit_level1_rate;
  let level2Rate = item.unit_level2_rate;

  // ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å cache ‡∏Å‡πà‡∏≠‡∏ô
  if (conversionRateCache.has(item.sku)) {
    const cachedRate = conversionRateCache.get(item.sku)!;
    level1Rate = cachedRate.unit_level1_rate;
    level2Rate = cachedRate.unit_level2_rate;
  } else {
    // ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô cache
    const conversionRate = await getConversionRate(item.sku);
    if (conversionRate) {
      level1Rate = conversionRate.unit_level1_rate;
      level2Rate = conversionRate.unit_level2_rate;
      setConversionRateCache(prev => new Map(prev.set(item.sku, conversionRate)));
    }
  }

  // ‡πÉ‡∏ä‡πâ fallback defaults ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  if (!level1Rate) level1Rate = 144;
  if (!level2Rate) level2Rate = 12;

  return (level1 * level1Rate) + (level2 * level2Rate) + level3;
};
```

### ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° Enhanced Debug Tool
- ‡∏™‡∏£‡πâ‡∏≤‡∏á `src/components/debug/SPOUTDebug.tsx` ‡∏û‡∏£‡πâ‡∏≠‡∏° dynamic conversion rates
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠" -> "üîç Debug SPOUT"
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SPOUT-LW02 ‡∏û‡∏£‡πâ‡∏≠‡∏° conversion rates ‡∏à‡∏£‡∏¥‡∏á
- ‡πÅ‡∏™‡∏î‡∏á console logs ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debugging

### ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Utility Functions
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `calculateTotalQuantityWithDynamicRates` ‡πÉ‡∏ô `unitCalculations.ts`
- ‡πÄ‡∏û‡∏¥‡πà‡∏° caching mechanism ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö performance
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á async ‡πÅ‡∏•‡∏∞ sync versions

### ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Components ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- InventoryTable.tsx: ‡πÉ‡∏ä‡πâ dynamic conversion rates
- SPOUTDebug.tsx: ‡πÉ‡∏ä‡πâ dynamic conversion rates
- BulkAddModal.tsx: ‡πÄ‡∏û‡∏¥‡πà‡∏° useConversionRates hook

## ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á ‚úÖ

### 1. SPOUT-LW02 ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- Console ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á: `üßÆ SPOUT-LW02 - Using DB rates (1000/100)`
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏° conversion rates ‡∏à‡∏£‡∏¥‡∏á
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 22 ‡∏•‡∏±‡∏á = 22,000 ‡∏ä‡∏¥‡πâ‡∏ô (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà 3,168 ‡∏ä‡∏¥‡πâ‡∏ô)

### 2. Debug Tool ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÅ‡∏™‡∏î‡∏á conversion rates ‡∏à‡∏£‡∏¥‡∏á: Level 1 Rate: 1000, Level 2 Rate: 100
- ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏à‡∏£‡∏¥‡∏á‡πÜ

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console Logs
‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ô‡∏µ‡πâ‡πÉ‡∏ô console:
```
üîç DEBUG SPOUT-LW02 - Using DB rates (1000/100) - Level1: 22x1000, Level2: 0x100, Level3: 2000
üßÆ SPOUT-LW02 - Using cached rates - Level1: 22x1000, Level2: 0x100, Level3: 2000
```

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á SPOUT-LW02

‡∏à‡∏≤‡∏Å Debug Tool ‡∏û‡∏ö‡∏ß‡πà‡∏≤ SPOUT-LW02 ‡∏°‡∏µ 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ **‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á**:
- 18 ‡∏•‡∏±‡∏á (M5/4) = 18,000 ‡∏ä‡∏¥‡πâ‡∏ô
- 22 ‡∏•‡∏±‡∏á + 2000 ‡∏ä‡∏¥‡πâ‡∏ô (M6/4) = 24,000 ‡∏ä‡∏¥‡πâ‡∏ô
- 24 ‡∏•‡∏±‡∏á (M7/4) = 24,000 ‡∏ä‡∏¥‡πâ‡∏ô
- 13 ‡∏•‡∏±‡∏á (M6/3) = 13,000 ‡∏ä‡∏¥‡πâ‡∏ô
- 15 ‡∏•‡∏±‡∏á (M5/3) = 15,000 ‡∏ä‡∏¥‡πâ‡∏ô

**‡∏™‡∏£‡∏∏‡∏õ:** ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á! ‚úÖ

## ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console browser ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö error messages
2. ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏à‡∏£‡∏¥‡∏á‡πÜ

## ‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- SPOUT-LW02 ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å" ‡∏Ñ‡∏ß‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô console