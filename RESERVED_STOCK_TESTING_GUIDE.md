# Reserved Stock System - Testing Guide

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏£‡∏∞‡∏ö‡∏ö Reserved Stock ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì "‡∏à‡∏≠‡∏á" ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ã‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢

### Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
```
1. pending     ‚Üí ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡∏≠‡∏á (stock ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
2. picked      ‚Üí ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß (stock ‡∏ñ‡∏π‡∏Å lock ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å, ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ)
3. completed   ‚Üí ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á, ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
```

---

## üìã Pre-requisites

### 1. Apply Database Migration
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://supabase.com/dashboard
- SQL Editor ‚Üí New Query
- Copy & Paste: `supabase/migrations/20251012_add_reserved_stock_system.sql`
- Run (Ctrl+Enter)
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏î‡∏π‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô `APPLY_RESERVED_STOCK_MIGRATION.md`

### 2. Verify Migration Success
```sql
-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á stock_reservations
SELECT COUNT(*) FROM public.stock_reservations;

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö View inventory_available
SELECT * FROM public.inventory_available LIMIT 5;

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Functions
SELECT routine_name
FROM information_schema.routines
WHERE routine_schema = 'public'
  AND routine_name IN ('reserve_stock_safe', 'cancel_reservation', 'fulfill_reservation');
```

---

## üß™ Testing Scenarios

### Test 1: ‡∏î‡∏π‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÉ‡∏ô InventoryTable ‡∏û‡∏£‡πâ‡∏≠‡∏° Reserved & Available

1. ‡πÄ‡∏Ç‡πâ‡∏≤ **‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Üí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å**
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå:
   - ‚úÖ "‡∏£‡∏ß‡∏° (‡∏ä‡∏¥‡πâ‡∏ô)" - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - ‚úÖ "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á (‡∏°‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô üîí ‡∏™‡∏µ‡∏™‡πâ‡∏°)
   - ‚úÖ "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ" - Available = Total - Reserved (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)

**Expected Result:**
- ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á: "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á "-"
- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á: ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞ Badge "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á"
- Tooltip: "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á (‡∏¢‡∏±‡∏á‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ)"

---

### Test 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Reservation ‡∏ú‡πà‡∏≤‡∏ô Picking System

#### Step 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ fulfillment_tasks ‡∏û‡∏£‡πâ‡∏≠‡∏° status = 'pending'
2. ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏™‡∏£‡πâ‡∏≤‡∏á Purchase Order ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà **‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‚Üí ‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢**

#### Step 2: Pick Items
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚Üí Inbound/Outbound ‚Üí Warehouse Picking**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Task ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Location ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ï‡πá‡∏≠‡∏Å
5. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏à‡∏≠‡∏á" (Pick)

**Expected Result:**
- ‚úÖ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: "‚úÖ ‡∏à‡∏≠‡∏á‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏¢‡∏±‡∏á‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ)"
- ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "Picked"
- ‚úÖ Database: ‡∏™‡∏£‡πâ‡∏≤‡∏á record ‡πÉ‡∏ô `stock_reservations` (status = 'active')
- ‚úÖ InventoryTable: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô, "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ" ‡∏•‡∏î‡∏•‡∏á

#### Verify in Database:
```sql
-- ‡∏î‡∏π reservation ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
SELECT * FROM stock_reservations ORDER BY reserved_at DESC LIMIT 5;

-- ‡∏î‡∏π inventory_items (reserved_quantity ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)
SELECT
  product_name,
  quantity,
  reserved_quantity,
  (quantity - reserved_quantity) AS available
FROM inventory_items
WHERE reserved_quantity > 0;
```

---

### Test 3: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å Reservation

1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Picking System (‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Test 2)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡πÑ‡∏ß‡πâ
3. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

**Expected Result:**
- ‚úÖ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: "‚úÖ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß"
- ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô "Pending"
- ‚úÖ Database: `stock_reservations.status = 'cancelled'`
- ‚úÖ `inventory_items.reserved_quantity` ‡∏•‡∏î‡∏•‡∏á (‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å)
- ‚úÖ InventoryTable: "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" ‡∏•‡∏î‡∏•‡∏á, "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ" ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô

---

### Test 4: Confirm Shipment (Fulfill Reservation)

1. Pick items (Test 2)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "üöö ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á"
3. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

**Expected Result:**
- ‚úÖ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: "üéâ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö"
- ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "Shipped"
- ‚úÖ Database: `stock_reservations.status = 'fulfilled'`
- ‚úÖ `inventory_items.quantity` ‡∏•‡∏î‡∏•‡∏á (‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á)
- ‚úÖ `inventory_items.reserved_quantity` ‡∏•‡∏î‡∏•‡∏á (release reservation)
- ‚úÖ InventoryTable: "‡∏£‡∏ß‡∏° (‡∏ä‡∏¥‡πâ‡∏ô)" ‡∏•‡∏î‡∏•‡∏á, "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" ‡∏•‡∏î‡∏•‡∏á

#### Verify:
```sql
-- ‡∏î‡∏π reservation ‡∏ó‡∏µ‡πà fulfilled
SELECT * FROM stock_reservations WHERE status = 'fulfilled' ORDER BY fulfilled_at DESC LIMIT 5;

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏´‡∏±‡∏Å‡∏à‡∏£‡∏¥‡∏á
SELECT product_name, quantity, reserved_quantity FROM inventory_items WHERE id = 'YOUR_INVENTORY_ITEM_ID';
```

---

### Test 5: Reserved Stock Dashboard

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ ‚Üí üîí Reserved Stock**

**Check Summary Cards:**
- ‚úÖ "‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô active reservations
- ‚úÖ "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á" - total reserved quantity
- ‚úÖ "Warehouses ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á"

**Check Summary by Warehouse Table:**
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á active reservations ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° warehouse
- ‚úÖ Total reserved quantity ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**Check Tabs:**
- ‚úÖ **‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á**: ‡πÅ‡∏™‡∏î‡∏á active reservations (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á" ‡∏™‡∏µ‡∏™‡πâ‡∏°)
- ‚úÖ **‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**: ‡πÅ‡∏™‡∏î‡∏á all reservations
- ‚úÖ **‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥**: ‡πÅ‡∏™‡∏î‡∏á fulfilled/cancelled reservations

**Test Cancel from Dashboard:**
1. Tab "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏î‡πÜ
3. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

**Expected Result:**
- ‚úÖ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: "‚úÖ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
- ‚úÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡∏à‡∏≤‡∏Å tab "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á"
- ‚úÖ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

## üîç Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Migration ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
**Solution:**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ table `inventory_items` ‡πÅ‡∏•‡∏∞ `fulfillment_items` ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö permissions (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Owner ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ ALTER TABLE)
- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô `APPLY_RESERVED_STOCK_MIGRATION.md`

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Pick ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Error)
**Possible Causes:**
- Stock ‡πÑ‡∏°‡πà‡∏û‡∏≠ (available_quantity < requested)
- `fulfillment_item_id` ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- Function `reserve_stock_safe` ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

**Debug:**
```sql
-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ function ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
SELECT routine_name FROM information_schema.routines
WHERE routine_name = 'reserve_stock_safe';

-- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö function ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
SELECT reserve_stock_safe(
  p_inventory_item_id := 'YOUR_ID',
  p_fulfillment_item_id := NULL,
  p_warehouse_code := 'A',
  p_location := 'A-01-01',
  p_level1_qty := 0,
  p_level2_qty := 0,
  p_level3_qty := 10,
  p_total_qty := 10,
  p_reserved_by := '00000000-0000-0000-0000-000000000000',
  p_notes := 'Test'
);
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Reserved quantity ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏ô UI
**Solution:**
- Refresh ‡∏´‡∏ô‡πâ‡∏≤ Browser (Ctrl+R)
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `inventory_available` view:
```sql
SELECT * FROM inventory_available WHERE id = 'YOUR_INVENTORY_ITEM_ID';
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Cancel ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (Error)
**Possible Causes:**
- Reservation ‡∏ñ‡∏π‡∏Å fulfill ‡πÅ‡∏•‡πâ‡∏ß (status = 'fulfilled')
- `reservation_id` ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**Debug:**
```sql
SELECT * FROM stock_reservations WHERE id = 'YOUR_RESERVATION_ID';
```

---

## ‚úÖ Testing Checklist

- [ ] Migration applied successfully
- [ ] View `inventory_available` ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- [ ] Functions ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏ï‡∏±‡∏ß‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- [ ] InventoryTable ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" ‡πÅ‡∏•‡∏∞ "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ"
- [ ] Pick item ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á reservation ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- [ ] Cancel pick ‚Üí release reservation ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- [ ] Confirm shipment ‚Üí fulfill reservation ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å
- [ ] Reserved Stock Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] Cancel ‡∏à‡∏≤‡∏Å Dashboard ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- [ ] Available stock ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Total - Reserved)

---

## üìä Monitoring Queries

### ‡∏î‡∏π Active Reservations ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```sql
SELECT * FROM reservation_history WHERE status = 'active' ORDER BY reserved_at DESC;
```

### ‡∏î‡∏π Inventory Items ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
```sql
SELECT
  product_name,
  location,
  quantity AS total,
  reserved_quantity AS reserved,
  (quantity - reserved_quantity) AS available
FROM inventory_available
WHERE reserved_quantity > 0
ORDER BY reserved_quantity DESC;
```

### ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Warehouse
```sql
SELECT * FROM reservation_summary_by_warehouse;
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á (24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
```sql
SELECT
  product_name,
  location,
  reserved_total_quantity,
  status,
  reserved_at,
  fulfilled_at,
  cancelled_at
FROM reservation_history
WHERE reserved_at > NOW() - INTERVAL '24 hours'
ORDER BY reserved_at DESC;
```

---

## üéâ Success Criteria

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:

1. ‚úÖ Pick item ‡∏™‡∏£‡πâ‡∏≤‡∏á reservation (‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)
2. ‚úÖ Cancel pick ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
3. ‚úÖ Confirm shipment ‡∏´‡∏±‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á
4. ‚úÖ Available stock = Total - Reserved (‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤)
5. ‚úÖ UI ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• reserved stock ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
6. ‚úÖ Dashboard ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ reservations ‡πÑ‡∏î‡πâ

---

**Happy Testing! üöÄ**
